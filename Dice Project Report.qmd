---
title: "STAT 230 Group Project Dice Material Analysis"
author: "Name of Group: Smiling Friends"
format: pdf
editor: visual
---

# Load packages
library(readxl)
library(dplyr)
library(tidyr)
library(car)
library(emmeans)
library(effectsize)
library(pwr)
library(ggplot2)
---

## Permission to make public

Is everyone in the group in agreement that this document may be made available to others (open link) as an example? Yes

## Purpose of the study

What is the purpose of this study? What is it about? Why is it useful?

The purpose of this study was to determine if the material used in making a die of any shape would impact its rolls. This is useful because those wishing to achieve more consistent or higher/lower rolls may wish to purchase a certain type of material for their dice. The dice in this study are commonly used in DnD, which is a game where the numbers any die rolls are very important to the success/failure of a character's actions.

## Methods of analysis

What methods/procedures did you choose for analyzing the data?

We used a two-way linear model to create a Type II Anova test which tested the Material used for the dice and the interaction on the type of die and the Material. It also tested if the type of die used impacted the rolls one could receive, which is negligible as it is fairly obvious that a d20 can roll significantly different than a d4.

## Sample size determination

How did you choose your sample size? If you used a power analysis, include the code below.

```{r}
# Here is my power analysis
# within_var <- summary(dice_fit)$sigma^2
# material_df <- as.data.frame(material_pw$emmeans)
# group_means <- material_df$emmean
# between_var <- var(group_means)
# groups <- nrow(material_df)
# n <- table(dice_data$Material)[1]
# 
# power_analysis <- power.anova.test(
#   groups = groups, n = n, between.var = between_var, within.var = within_var)
# power_analysis
# 
# required_n <- power.anova.test(
#   groups = groups, between.var = between_var, within.var = within_var, power = 0.8)
# required_n
```

Here is an explanation of my power analysis if I used one.

Output was:\
Balanced one-way analysis of variance power calculation

groups = 4 n = 180 between.var = 0.0220679 within.var = 10.11178 sig.level = 0.05 power = 0.1282088

NOTE: n is number in each group

Balanced one-way analysis of variance power calculation

groups = 4 n = 1666.206 between.var = 0.0220679 within.var = 10.11178 sig.level = 0.05 power = 0.8

NOTE: n is number in each group

To achieve 80% power, approximately 278 rolls would be required per die type for each material to achieve 1667 n rolls per material. As this would be extremely time consuming, 30 rolls were conducted per die type per material.

## Import data

Here is an explanation of the data I collected.

```{r}
# Here is the code used to import my data. The data link is public so that anyone can replicate my analysis
Dnd_Dice_R_Data <- read_excel("C:/Users/srhal/Downloads/Dnd Dice R Data.xlsx")

dice_data <- Dnd_Dice_R_Data %>%
pivot_longer(
cols = c(D20, D12, D10, D8, D6, D4),
names_to = "die_type",
values_to = "roll"
)

expected_means <- data.frame(
die_type = c("D4", "D6", "D8", "D10", "D12", "D20"),
expected_mean = c(2.5, 3.5, 4.5, 5.5, 6.5, 10.5)
)

dice_data <- dice_data %>%
left_join(expected_means, by = "die_type")
```

## Assumption checking

Here is how I checked the model assumptions as well as the results of the check(s).

`{r} # Here is the code used to check the assumptions}`

```{r}
dice_fit <- lm(roll ~ die_type * Material, data = dice_data)

dice_anova <- Anova(dice_fit)
dice_anova
```

## Visualizations

Here is an explanation of the visualizations I used.

`{r} # Here is the code used to visualize my data}`

```{r}
qqPlot(dice_fit, distribution = "norm")

# Equal Variance and Mean = 0
plot(dice_fit, which = 1)
```

## Analysis

Here is an explanation of the analysis I used.

`{r} # Here is the code used to analyze my data}`

```{r}
material_pw <- emmeans(dice_fit, pairwise ~ Material)
material_pw
m_plot <- emmip(material_pw, ~ Material, CIs = TRUE)
m_plot + scale_x_discrete(labels = function(x) toupper(x)) + labs(x= "Material", y = "Mean Roll") + theme_minimal()
```

```{r}

die_type_pw <- emmeans(dice_fit, pairwise ~ Material | die_type)
die_type_pw
dt_plot <- emmip(die_type_pw, Material ~ die_type, CIs = TRUE)
dt_plot + scale_x_discrete(labels = function(x) toupper(x)) + labs(x= "Die Type", y = "Mean Roll") + theme_minimal()
```

## Results

Here are the results of the analysis and visualizations

The material used in constructing the die has no significant outcome on the roll across all shapes of dice used. In pairwise comparisons, there were some apparent differences in materials used for different dice, however none had a p value below 0.24 and thus none of the differences can be said to be significantly different.

## Conclusions

Here are the conclusions of my study, the shortcomings, issues I encountered along the way, and recommendations for future research in this area.

We conclude that since the material used to make dice is statistically negligible in the performance of the dice, those who wish to buy dice should choose more budget friendly options if performance is their only concern, as expensive or fancy dice will should not significantly impact their rolls. It would be nice to roll enough times to achieve 80% power, as well as buy more material types such as wood or liquid-core dice to make more comparisons; however both time and money played a factor into the feasibility of expanding the scope of this experiment at this time.
